version: 2

models:
  - name: dim_job_posting_scd
    description: |
      Silver layer SCD Type 2 dimension for job postings.
      Maintains historical changes to job posting attributes over time.
      
      **Source**: br_athena_job_posting_cdc
      **Grain**: One row per job posting per change
      **Type**: SCD Type 2 (Slowly Changing Dimension)
      
      **SCD Implementation**:
      - Tracks full history of changes
      - Uses effective_from and effective_to dates
      - is_current flag identifies the latest version
      
      **Key Use Cases**:
      - Historical reporting on job posting changes
      - Trend analysis of posting modifications
      - Audit trail for recruitment process
    columns:
      - name: surrogate_key
        description: "Surrogate key for the SCD record (unique per version)"
        # tests:
        #   - unique
        #   - not_null
      
      - name: job_posting_id
        description: "Natural key - job posting identifier (same across versions)"
        # tests:
        #   - not_null
      
      - name: effective_from
        description: "Start date when this version became effective"
        # tests:
        #   - not_null
      
      - name: effective_to
        description: "End date when this version ceased to be effective (NULL for current record)"
      
      - name: is_current
        description: "Boolean flag indicating if this is the current/active version"
        # tests:
        #   - not_null
        #   - accepted_values:
        #       values: [true, false]
      
      - name: version_number
        description: "Sequential version number for this job posting"
        # tests:
        #   - not_null
